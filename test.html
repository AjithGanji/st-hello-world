import pandas as pd
import plotly.graph_objects as go
from datetime import datetime

# Example DataFrame
data = {
    'A': ['00:00', '00:15', '00:30', '00:45', '01:00'],
    'B': [10, 20, 15, 25, 30],
    'C': [5, 8, 6, 10, 12],
    'D': [2, 4, 3, 5, 6],
    'E': [8, 12, 10, 15, 18],
    'F': [3, 5, 4, 7, 6],
    'G': [6, 9, 8, 12, 10],
    'H': [4, 7, 6, 9, 8]
}

df = pd.DataFrame(data)

# Convert column A to datetime format
df['A'] = pd.to_datetime(df['A'], format='%H:%M')

# Extract x (A), y (B), and z (C-H) values
x = df['A']
y = df['B']
z_columns = ['C', 'D', 'E', 'F', 'G', 'H']

# Create a 3D line plot using Plotly
fig = go.Figure()

# Add lines connecting points in 3D space
for i in range(len(df)):
    x_val = x[i]
    y_val = y[i]
    z_vals = [df[col][i] for col in z_columns]
    fig.add_trace(go.Scatter3d(
        x=[x_val] * len(z_columns),
        y=[y_val] * len(z_columns),
        z=z_vals,
        mode='lines+markers',
        line=dict(color='blue', width=3),
        name=f'Data Point {i+1}'
    ))

# Update layout and display options
fig.update_layout(
    title='3D Line Plot with Multiple Z Values',
    scene=dict(
        xaxis_title='Time (A-axis)',
        yaxis_title='B-axis',
        zaxis_title='Other Columns (C-H)'
    ),
    width=800,
    height=600
)

# Save the plot as an HTML file
plot_filename = '3d_plot.html'
fig.write_html(plot_filename)

# Read the contents of the plot HTML file
with open(plot_filename, 'r') as file:
    plot_html = file.read()

# HTML template with inserted 3D plot
html_template = f"""
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>One-Page Report</title>
</head>
<body>
    <h1>Generation Sources and Demand Forecast Report</h1>
    
    <div id="3d-plots">
        {plot_html}  <!-- Insert Plotly 3D plot HTML here -->
    </div>
    
    <h2>Summary of Data</h2>
    
    <table>
        <thead>
            <tr>
                <th>Generation Source</th>
                <th>Demand Forecast</th>
                <th>Inadequacy</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Source 1</td>
                <td>100</td>
                <td>20</td>
            </tr>
            <tr>
                <td>Source 2</td>
                <td>150</td>
                <td>10</td>
            </tr>
            <!-- Add more rows as needed -->
        </tbody>
    </table>
    
    <h2>Details of Data</h2>
    
    <p>Here you can provide detailed information about the generation sources and demand forecast data.</p>
</body>
</html>
"""

# Write the combined HTML content to a new HTML file
output_filename = 'report_with_plot.html'
with open(output_filename, 'w') as outfile:
    outfile.write(html_template)

print(f"HTML report with 3D plot inserted: {output_filename}")
